<title>Partida</title>
<link rel="stylesheet" href="/public/css/partidaStyle.css">
<body>
<header class="header">
    <img src="/public/imagenes/Logo.png" alt="logo" class="logo">
    <link rel="stylesheet" href="/public/css/partidaStyle.css">
    <form method="POST" action="/Preguntados/inicio/logout">
        <input class="logout-btn" type="submit" value="Cerrar sesiÃ³n">
    </form>
</header>
<main class="container">
    <h1>Partida iniciada</h1>
    <p>Tu oponente es: <strong>{{nombreOponente}}</strong></p>
    <p>Preguntas respondidas: <strong>{{cantidadCorrectas}}</strong></p>
    <p id="cronometro"></p>
    <div id="barraTiempo">
        <div id="tiempo"> </div>
    </div>
    <script>
    
    
        const tiempoTotal = 15;  //aca podemos setear el tiempo por pregunta
        var tiempoRestante = tiempoTotal; 
        var cronometroElemento = document.getElementById('cronometro');
        var relleno = document.getElementById('tiempo');

        setInterval(() => {
        fetch('/partida/mostrarTiempo')
            .then(res => res.json())
            .then(data => {
            console.log("Tiempo restante:", data);
            document.getElementById("cronometro").innerText = data.tiempoRestante;
            })    



            /*efecto visual de la barra de tiempo
            if (tiempoRestante > 0) {
                tiempoRestante--;
                var porcentajeRestante = (tiempoRestante / tiempoTotal) * 100;
                relleno.style.width = porcentajeRestante + '%';
                
            }*/
        }, 1000);
    </script>
    <p>La pregunta es: <strong>{{pregunta}}</strong></p>
    <div id="pregunta-container">

<!--        Podriamos manejar esto con un formulario para no hacer tan extensa la URL-->
        {{#Respuestas}}
                <a href="/partida/evaluarTurno?respuestaElegida={{id}}&turno={{id_turno}}" class="list-group-item link-card mb-3 rounded">
                    <h5 class="mb-0">{{opcion}}</h5>
                </a>
        {{/Respuestas}}
    </div>
    
    
</main>
<!--<script>-->
<!--    window.addEventListener("beforeunload", function() {-->
<!--        navigator.sendBeacon("/?controller=partida&method=finalizarPartida");-->
<!--    });-->
<!--</script>-->
</body>