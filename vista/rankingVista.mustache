<title>Ranking</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<link rel="stylesheet" href="/public/css/vistas/rankingStyle.css">
<link rel="stylesheet" href="/public/css/componentes/headerComponente.css">
</head>

<body>

  <header class="header"> 
    <h2 class="titulo">Preguntados</h2>
    <div class="user-info">
        <form method="POST" action="/Preguntados/inicio/logout">
        <input class="logout-btn" type="submit" value="Cerrar sesión">
        </form>
        <p class="username">{{usuario}}</p>

        <a href="/perfil">
        {{#foto_perfil}}
            <img src="/{{foto_perfil}}" alt="{{usuario}}" class="img-fluid rounded-circle" width="50" height="50">
        {{/foto_perfil}}

        {{^foto_perfil}}
            <img src="/public/imagenes/usuarioImagenDefault.png" alt="{{usuario}}" class="img-fluid rounded-circle" width="50" height="50">
        {{/foto_perfil}}
        </a>
    </div>
  </header>

  <main class="container py-5">
    <div class="text-center mb-5">
      <h1 class="fw-bold">Ranking</h1>
      <p class="text-muted">
        Bienvenido al ranking!
      </p>
    </div>

  <form id="rankingForm" action="/ranking/obtenerListaMejoresJugadoresPorRango" method="GET">

      <div class="container mt-4">
        <h3 class="text-light mb-3">Ranking de usuarios</h3>
        <input type="hidden" name="rango" id="rango" value="pro">
        <input type="button" class="btn btn-light mb-3" value="rango pro" onclick="cambiarRango('pro')">
        <input type="button" class="btn btn-light mb-3" value="rango medio" onclick="cambiarRango('medio')">
        <input type="button" class="btn btn-light mb-3" value="rango novato" onclick="cambiarRango('novato')">
      </div>
      
      <div> <!-- Limite de usuarios a mostrar, abria que ver como actualizar -->
        <select name="limite" onchange="document.getElementById('rankingForm').submit()">
          <option value="10">filtro</option>
          <option value="1">1</option>
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>  
      </div>
    </form>


      <form id="rankingCategoriaForm" action="/ranking/obtenerListaMejoresJugadoresPorCategoria" method="GET">

      <div class="container mt-4">
        <h3 class="text-light mb-3">Ranking de usuarios categoria</h3>
        <input type="hidden" name="categoria" id="categoria" value="Historia">
        <input type="button" class="btn btn-light mb-3" value="Historia" onclick="cambiarCategoria('Historia')">
        <input type="button" class="btn btn-light mb-3" value="Deportes" onclick="cambiarCategoria('Deportes')">
        <input type="button" class="btn btn-light mb-3" value="Entretenimiento" onclick="cambiarCategoria('Entretenimiento')">
        <input type="button" class="btn btn-light mb-3" value="Informática" onclick="cambiarCategoria('Informática')">
        <input type="button" class="btn btn-light mb-3" value="Matematicas" onclick="cambiarCategoria('Matematicas')">


      </div>
      
      <div> <!-- Limite de usuarios a mostrar, abria que ver como actualizar -->
        <select name="limite" onchange="document.getElementById('rankingCategoriaForm').submit()">
          <option value="1">1</option>
          <option value="5">5</option>
          <option value="10" selected>10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>  
      </div>
    </form>

    <script>

    function cambiarRango(rango) {
      document.getElementById('rango').value = rango;
      document.getElementById('rankingForm').submit();
    }

    function cambiarCategoria(categoria) {
      document.getElementById('categoria').value = categoria;
      document.getElementById('rankingCategoriaForm').submit();
    }
    </script>

            <table class="table table-dark table-striped table-hover">
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Usuario</th>
                        <th>Puntaje</th>
                        <th>Pais</th>
                    </tr>
                </thead>
                <tbody  style="text-align: center">
                    {{#usuarios}}
                        <tr>

                            <td>
                                <!-- no se por qué cuando muestra el ranking sin filtro muestra la foto de perfil del usuario en sesion en los otros jugadores
                                cuando filtras se sale-->
                                {{#foto_perfil}}
                                <img src="/{{foto_perfil}}" alt="{{usuario}}" class="img-fluid rounded-circle" width="50" height="50">
                                {{/foto_perfil}}

                                {{^foto_perfil}}
                                <img src="/public/imagenes/usuarioImagenDefault.png" alt="{{usuario}}" class="img-fluid rounded-circle" width="50" height="50">
                                {{/foto_perfil}}
                            </td>
                            <td>{{usuario}}</td>
                            <td>{{mejor_puntaje}}</td>
                            <td>{{pais}}</td>
                        </tr>
                    {{/usuarios}}
                    {{^usuarios}}
                        <tr>
                            <td colspan="5" class="text-center text-muted">
                                No has terminado ninguna partida aún.
                            </td>
                        </tr>
                    {{/usuarios}}
                </tbody>
            </table>

    <div class="text-center mt-5">
      <a href="/inicio" class="btn btn-secondary">Volver</a>
    </div>
  </main>
</body>
</html>